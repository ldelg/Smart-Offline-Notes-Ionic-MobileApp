import{c as ie,d as ae,e as re,f as se}from"./chunk-KHNVQIKD.js";import"./chunk-VUKOYLCU.js";import"./chunk-QUJFQN2Y.js";import"./chunk-CFHZKLO3.js";import"./chunk-XX63LXAP.js";import"./chunk-E6R74AAZ.js";import"./chunk-7FY2OE2O.js";import"./chunk-3AKH2QW5.js";import"./chunk-MO3Y5KPV.js";import"./chunk-UHNYFROW.js";import"./chunk-IDC5F2JZ.js";import{a as Z,d as ee,e as te,i as ne,m as oe}from"./chunk-IRPPD5UH.js";import"./chunk-KI3OGBFQ.js";import"./chunk-CFOVYPQF.js";import"./chunk-Z3TYMMPC.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-ZL4KYEC3.js";import"./chunk-CKP3SGE2.js";import"./chunk-5QDBXRKG.js";import{A as r,Ca as T,Cb as Q,Da as E,Db as X,E as w,Ea as I,Fa as N,Ga as F,Ha as U,I as x,J as _,K as M,Ka as A,Ma as D,N as g,O as i,P as o,Q as m,U as y,V as u,W as h,ba as S,ca as s,cb as z,da as v,db as Y,ea as k,eb as G,ib as L,jb as j,ka as R,kb as V,n as d,p as P,pb as B,q as O,sb as K,tb as $,ub as q,w as C,xb as H,yb as W,zb as J}from"./chunk-P77PPINA.js";import"./chunk-447CKG3T.js";import"./chunk-CDZFCBFW.js";import"./chunk-E2CLONXR.js";import"./chunk-KRDHHS7Z.js";import"./chunk-JVTPOORY.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-LRFGNCHE.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{e as p}from"./chunk-JHI3MBHO.js";function ce(a,c){if(a&1&&(i(0,"span",22),s(1),o()),a&2){let l=h(2);r(),v(l.modelProgressLabel())}}function le(a,c){if(a&1&&(i(0,"div",19),m(1,"ion-spinner",20),i(2,"ion-text"),s(3,"Transcribing..."),o()(),i(4,"div",21)(5,"span"),s(6),o(),_(7,ce,2,1,"span",22),o()),a&2){let l=h();r(6),v(l.modelStatusLine()),r(),M(l.modelProgressLabel()?7:-1)}}function de(a,c){if(a&1){let l=y();i(0,"form",23),u("ngSubmit",function(){P(l);let t=h();return O(t.saveNote())}),i(1,"ion-item",24),m(2,"ion-input",25),o(),i(3,"ion-item",24),m(4,"ion-textarea",26),o(),i(5,"ion-button",27),m(6,"ion-icon",28),s(7," Save Note "),o()()}if(a&2){let l=h();g("formGroup",l.noteForm),r(5),g("disabled",l.noteForm.invalid)}}var Oe=(()=>{let c=class c{constructor(){this.store=d(se),this.networkService=d(ae),this.settings=d(ie),this.transcriptionService=d(re),this.alertController=d(H),this.fb=d(A),this.isRecording=C(!1),this.statusMessage=C(""),this.isManualEntry=C(!1),this.noteForm=this.fb.group({title:[""],body:["",[T.minLength(2)]]}),this.chunks=[],Z({micOutline:ne,stopCircleOutline:oe,cloudUploadOutline:ee,createOutline:te}),this.store.loadNotes(),R(()=>{!this.store.loading()&&this.statusMessage()==="Transcribing audio..."&&(this.statusMessage.set("Transcription complete!"),this.showSuccessAlert("Transcription Complete","Your audio has been transcribed and saved as a note!").catch(console.error),setTimeout(()=>this.statusMessage.set("Ready to create your next note."),2e3))})}noModelDownloaded(){let e=this.networkService.isOnline(),t=this.settings.lastUsedModel()!==null;return!e&&!t}startRecording(){return p(this,null,function*(){if(!navigator.mediaDevices?.getUserMedia){yield this.showAlert("Recording Not Supported","Your device does not support audio recording. Please use the upload option instead.");return}if(this.noModelDownloaded()){yield this.showAlert("No Model Available Offline","You are currently offline and no model is downloaded. Please connect to the internet to download the model once");return}try{this.mediaStream=yield navigator.mediaDevices.getUserMedia({audio:!0}),this.mediaRecorder=new MediaRecorder(this.mediaStream),this.chunks=[],this.mediaRecorder.ondataavailable=e=>{e.data.size>0&&this.chunks.push(e.data)},this.mediaRecorder.onstop=()=>{let e=new Blob(this.chunks,{type:"audio/webm"});this.processFile(new File([e],"recording.webm",{type:e.type}),"Recording"),this.chunks=[]},this.mediaRecorder.start(),this.isRecording.set(!0),this.statusMessage.set("Recording... Tap stop when done.")}catch(e){console.error(e),yield this.showAlert("Microphone Permission Required","Please allow microphone access in your browser settings to record audio. You can also upload audio files instead.")}})}stopRecording(){this.mediaRecorder?.state==="recording"&&(this.mediaRecorder.stop(),this.mediaStream?.getTracks().forEach(e=>e.stop())),this.isRecording.set(!1)}handleUpload(e){let t=e.target,n=t?.files?.[0];n&&(this.processFile(n,"Upload"),t.value="")}saveNote(){return p(this,null,function*(){if(this.noteForm.invalid){this.noteForm.markAllAsTouched();return}let{title:e,body:t}=this.noteForm.value,n=(t||"").trim();if(!n){this.statusMessage.set("Please write something before saving.");return}let f={id:crypto.randomUUID(),title:(e||"Untitled note").trim(),body:n,createdAt:Date.now(),source:"Typed"};this.store.addNote(f),this.noteForm.reset(),this.statusMessage.set("Note saved successfully."),yield this.showSuccessAlert("Note Created","Your note has been saved successfully!")})}processFile(e,t){this.statusMessage.set("Transcribing audio..."),this.store.transcribe({file:e,source:t})}showSuccessAlert(e,t){return p(this,null,function*(){yield(yield this.alertController.create({header:e,message:t,buttons:["OK"],cssClass:"success-alert"})).present()})}showAlert(e,t){return p(this,null,function*(){yield(yield this.alertController.create({header:e,message:t,buttons:["OK"],cssClass:"error-alert"})).present()})}modelStatusLine(){let t=this.transcriptionService.modelStatus?.();return t||`Model: ${this.settings.model()}`}modelProgressLabel(){let t=this.transcriptionService.modelProgress?.();return typeof t!="number"?null:`${Math.round(t)}%`}};c.\u0275fac=function(t){return new(t||c)},c.\u0275cmp=w({type:c,selectors:[["app-create"]],decls:42,vars:9,consts:[[3,"translucent"],[1,"create-content"],[1,"content-wrapper"],[1,"glass-card"],[1,"record-card"],[1,"waveform"],[1,"bar"],["type","button",1,"record-button",3,"click"],[3,"name"],[1,"instruction-pill"],[1,"upload-panel"],["for","audioInput",1,"upload-label"],[1,"upload-caption"],["id","audioInput","type","file","accept","audio/*,video/mp4,video/webm","aria-label","Upload audio file",3,"change"],[1,"create-card-content"],[1,"manual-toggle"],[1,"manual-title"],[3,"ionChange","checked"],[1,"manual-form",3,"formGroup"],[1,"processing"],["name","lines"],[1,"processing-meta"],[1,"processing-meta__progress"],[1,"manual-form",3,"ngSubmit","formGroup"],["lines","none"],["formControlName","title","label","Title","labelPlacement","stacked","placeholder","Note title"],["formControlName","body","label","Content","labelPlacement","stacked","placeholder","Write your note here...","rows","6","autoGrow","true"],["type","submit","expand","block",1,"create-button",3,"disabled"],["slot","start","name","create-outline"]],template:function(t,n){t&1&&(i(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),s(3,"Create Note"),o()()(),i(4,"ion-content",1)(5,"div",2)(6,"ion-card",3)(7,"ion-card-content",4)(8,"div",5),m(9,"span",6)(10,"span",6)(11,"span",6)(12,"span",6)(13,"span",6)(14,"span",6)(15,"span",6)(16,"span",6)(17,"span",6)(18,"span",6)(19,"span",6)(20,"span",6)(21,"span",6)(22,"span",6)(23,"span",6),o(),i(24,"button",7),u("click",function(){return n.isRecording()?n.stopRecording():n.startRecording()}),m(25,"ion-icon",8),o(),i(26,"div",9),s(27),o(),i(28,"div",10)(29,"label",11),s(30," Upload "),o(),i(31,"div",12),s(32,"Upload an audio file"),o()(),i(33,"input",13),u("change",function(b){return n.handleUpload(b)}),o(),_(34,le,8,2),o()(),i(35,"ion-card",3)(36,"ion-card-content",14)(37,"div",15)(38,"div",16),s(39,"Manual Entry"),o(),i(40,"ion-toggle",17),u("ionChange",function(b){return n.isManualEntry.set(b.detail.checked)}),o()(),_(41,de,8,2,"form",18),o()()()()),t&2&&(g("translucent",!0),r(8),S("waveform--active",n.isRecording()),r(16),x("aria-pressed",n.isRecording()),r(),g("name",n.isRecording()?"stop-circle-outline":"mic-outline"),r(2),k(" ",n.isRecording()?"Recording... Tap to stop":"Tap the record button to start recording."," "),r(7),M(n.store.loading()?34:-1),r(6),g("checked",n.isManualEntry()),r(),M(n.isManualEntry()?41:-1))},dependencies:[j,q,$,L,z,W,Y,G,V,J,Q,B,K,X,D,N,E,I,F,U],styles:[".create-content[_ngcontent-%COMP%]{--background: linear-gradient(180deg, #181818 0%, #0d0d0d 65%, #050505 100%);--padding-start: clamp(1rem, 3vw, 2.5rem);--padding-end: clamp(1rem, 3vw, 2.5rem);--padding-top: 1.25rem;--padding-bottom: 1.25rem}.content-wrapper[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;display:flex;flex-direction:column;gap:1.5rem}.glass-card[_ngcontent-%COMP%]{background:#1f1f1f;border:1px solid #2a2a2a;border-radius:20px;box-shadow:0 20px 40px #00000073}.record-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1.5rem;padding:2rem 1.5rem}.waveform[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.35rem;height:34px}.waveform[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]{width:4px;border-radius:999px;background:#76d6ffe6;height:12px;opacity:.8}.waveform--active[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_waveform-pulse 1.2s ease-in-out infinite;transform-origin:center}.waveform--active[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(2){animation-delay:.1s}.waveform--active[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(3){animation-delay:.2s}.waveform--active[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(4){animation-delay:.3s}.waveform--active[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(5){animation-delay:.4s}.waveform--active[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(6){animation-delay:.5s}.waveform--active[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(7){animation-delay:.6s}.waveform--active[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(8){animation-delay:.7s}.waveform--active[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(9){animation-delay:.6s}.waveform--active[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(10){animation-delay:.5s}.waveform--active[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(11){animation-delay:.4s}.waveform--active[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(12){animation-delay:.3s}.waveform--active[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(13){animation-delay:.2s}.waveform--active[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(14){animation-delay:.1s}@keyframes _ngcontent-%COMP%_waveform-pulse{0%,to{transform:scaleY(.4);opacity:.5}50%{transform:scaleY(1);opacity:1}}@media (prefers-reduced-motion: reduce){.waveform--active[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]{animation:none}}.waveform[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(2), .waveform[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(14){height:16px}.waveform[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(3), .waveform[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(13){height:20px}.waveform[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(4), .waveform[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(12){height:26px}.waveform[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(5), .waveform[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(11){height:30px}.waveform[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(6), .waveform[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(10){height:24px}.waveform[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(7), .waveform[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]:nth-child(9){height:18px}.record-button[_ngcontent-%COMP%]{width:96px;height:96px;border-radius:50%;border:2px solid rgba(118,214,255,.8);background:#08080899;display:grid;place-items:center;color:#7ad8ff;font-size:42px;box-shadow:0 0 0 8px #7ad8ff1f;transition:transform .2s ease,box-shadow .2s ease}.record-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:40px}.record-button[_ngcontent-%COMP%]:active{transform:scale(.98);box-shadow:0 0 0 12px #7ad8ff2e}.instruction-pill[_ngcontent-%COMP%]{padding:.75rem 1.25rem;border-radius:999px;background:#12121299;border:1px solid rgba(255,255,255,.08);color:#ffffffd9;text-align:center;font-size:.95rem}.upload-panel[_ngcontent-%COMP%]{width:100%;display:grid;gap:.5rem;justify-items:center}.upload-label[_ngcontent-%COMP%]{width:100%;text-align:center;padding:.9rem 1rem;border-radius:16px;background:#121212cc;color:#7ad8ff;font-weight:600;border:1px solid rgba(122,216,255,.3);cursor:pointer;transition:all .2s ease}.upload-label[_ngcontent-%COMP%]:hover{background:#7ad8ff1a}.upload-caption[_ngcontent-%COMP%]{color:#ffffff8c;font-size:.85rem}#audioInput[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;opacity:0;overflow:hidden}.processing[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.75rem;padding:1rem 0 0;color:#ffffffd9}.processing-meta[_ngcontent-%COMP%]{margin-top:.5rem;font-size:.85rem;color:#ffffff8c;letter-spacing:.02em;text-align:center;display:flex;align-items:center;justify-content:center;gap:.5rem}.processing-meta__progress[_ngcontent-%COMP%]{color:#7ad8ffcc;font-weight:600}.manual-toggle[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.75rem .5rem;color:#ffffffd9;font-weight:600}.manual-title[_ngcontent-%COMP%]{font-size:1rem}.manual-form[_ngcontent-%COMP%]{margin-top:.5rem}.create-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: transparent;--border-color: rgba(255, 255, 255, .12)}.create-content[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%], .create-content[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%]{--background: transparent;--padding-start: 0;--padding-end: 0;--highlight-color-focused: var(--ion-color-primary);--highlight-color: var(--ion-color-primary);color:#fff}.create-content[_ngcontent-%COMP%]   .native-input[_ngcontent-%COMP%], .create-content[_ngcontent-%COMP%]   .native-textarea[_ngcontent-%COMP%]{background:transparent!important}.create-card-content[_ngcontent-%COMP%]{padding:12px 16px 18px}.create-button[_ngcontent-%COMP%]{margin:15px 0 0}"]});let a=c;return a})();export{Oe as CreatePage};
