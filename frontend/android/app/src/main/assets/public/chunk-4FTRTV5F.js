import{a as Q}from"./chunk-4YYS34RD.js";import{a as W,d as q,e as z,g as L,i as J}from"./chunk-7AYWC2PE.js";import{A as l,B as n,Ba as G,C as i,Ca as Y,D as a,Da as B,F as u,Ga as j,Ha as V,Ia as H,Ka as K,L as r,S as _,aa as v,ba as y,ca as M,da as x,ea as w,fa as P,ga as S,ia as O,k as g,ma as k,na as R,oa as I,pa as T,qa as N,ra as E,s as h,sa as F,t as d,ta as A,u as f,ua as U,w as b,x as C,ya as D}from"./chunk-MPTE3GQA.js";import"./chunk-Y2PDZ72K.js";import"./chunk-Z6NEOT2M.js";import"./chunk-MSMJJC2X.js";import"./chunk-53OGNGEH.js";import"./chunk-JVTPOORY.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-REYR55MP.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{e as p}from"./chunk-JHI3MBHO.js";function Z(c,s){c&1&&(n(0,"div",13),a(1,"ion-spinner",21),n(2,"ion-text"),r(3,"Transcribing..."),i()())}var de=(()=>{let s=class s{constructor(){this.store=g(Q),this.fb=g(S),this.alertController=g(j),this.isRecording=h(!1),this.statusMessage=h(""),this.noteForm=this.fb.group({title:[""],body:["",[v.minLength(2)]]}),this.chunks=[],W({micOutline:L,stopCircleOutline:J,cloudUploadOutline:q,createOutline:z}),this.store.loadNotes(),_(()=>{!this.store.loading()&&this.statusMessage()==="Transcribing audio..."&&(this.statusMessage.set("Transcription complete!"),this.showSuccessAlert("Transcription Complete","Your audio has been transcribed and saved as a note!").catch(console.error),setTimeout(()=>this.statusMessage.set("Ready to create your next note."),2e3))})}startRecording(){return p(this,null,function*(){if(!navigator.mediaDevices?.getUserMedia){yield this.showAlert("Recording Not Supported","Your device does not support audio recording. Please use the upload option instead.");return}try{this.mediaStream=yield navigator.mediaDevices.getUserMedia({audio:!0}),this.mediaRecorder=new MediaRecorder(this.mediaStream),this.chunks=[],this.mediaRecorder.ondataavailable=e=>{e.data.size>0&&this.chunks.push(e.data)},this.mediaRecorder.onstop=()=>{let e=new Blob(this.chunks,{type:"audio/webm"});this.processFile(new File([e],"recording.webm",{type:e.type}),"Recording"),this.chunks=[]},this.mediaRecorder.start(),this.isRecording.set(!0),this.statusMessage.set("Recording... Tap stop when done.")}catch(e){console.error(e),yield this.showAlert("Microphone Permission Required","Please allow microphone access in your browser settings to record audio. You can also upload audio files instead.")}})}stopRecording(){this.mediaRecorder?.state==="recording"&&(this.mediaRecorder.stop(),this.mediaStream?.getTracks().forEach(e=>e.stop())),this.isRecording.set(!1)}handleUpload(e){let o=e.target,t=o?.files?.[0];t&&(this.processFile(t,"Upload"),o.value="")}saveNote(){return p(this,null,function*(){if(this.noteForm.invalid){this.noteForm.markAllAsTouched();return}let{title:e,body:o}=this.noteForm.value,t=(o||"").trim();if(!t){this.statusMessage.set("Please write something before saving.");return}let m={id:crypto.randomUUID(),title:(e||"Untitled note").trim(),body:t,createdAt:Date.now(),source:"Typed"};this.store.addNote(m),this.noteForm.reset(),this.statusMessage.set("Note saved successfully."),yield this.showSuccessAlert("Note Created","Your note has been saved successfully!")})}processFile(e,o){this.statusMessage.set("Transcribing audio..."),this.store.transcribe({file:e,source:o})}showSuccessAlert(e,o){return p(this,null,function*(){yield(yield this.alertController.create({header:e,message:o,buttons:["OK"],cssClass:"success-alert"})).present()})}showAlert(e,o){return p(this,null,function*(){yield(yield this.alertController.create({header:e,message:o,buttons:["OK"],cssClass:"error-alert"})).present()})}};s.\u0275fac=function(o){return new(o||s)},s.\u0275cmp=f({type:s,selectors:[["app-create"]],decls:40,vars:6,consts:[[3,"translucent"],[1,"create-content"],[1,"content-wrapper"],[1,"glass-card"],[1,"create-card-header"],[1,"controls"],["expand","block","color","primary",3,"click","disabled"],["slot","start","name","mic-outline"],["expand","block","color","danger",3,"click","disabled"],["slot","start","name","stop-circle-outline"],["for","audioInput",1,"upload-label"],["name","cloud-upload-outline"],["id","audioInput","type","file","accept","audio/*,video/mp4,video/webm","aria-label","Upload audio file",3,"change"],[1,"processing"],[1,"create-card-content"],[3,"ngSubmit","formGroup"],["lines","none"],["formControlName","title","label","Title","labelPlacement","stacked","placeholder","Note title"],["formControlName","body","label","Content","labelPlacement","stacked","placeholder","Write your note here...","rows","6","autoGrow","true"],["type","submit","expand","block",1,"create-button",3,"disabled"],["slot","start","name","create-outline"],["name","lines"]],template:function(o,t){o&1&&(n(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),r(3,"Create Note"),i()()(),n(4,"ion-content",1)(5,"div",2)(6,"ion-card",3)(7,"ion-card-header",4)(8,"ion-card-subtitle"),r(9,"Audio Capture"),i(),n(10,"ion-card-title"),r(11,"Record or Upload"),i()(),n(12,"ion-card-content")(13,"div",5)(14,"ion-button",6),u("click",function(){return t.startRecording()}),a(15,"ion-icon",7),r(16," Start Recording "),i(),n(17,"ion-button",8),u("click",function(){return t.stopRecording()}),a(18,"ion-icon",9),r(19," Stop Recording "),i(),n(20,"label",10),a(21,"ion-icon",11),r(22," Upload Audio (WAV/MP3/MP4) "),i(),n(23,"input",12),u("change",function(X){return t.handleUpload(X)}),i(),b(24,Z,4,0,"div",13),i()()(),n(25,"ion-card",3)(26,"ion-card-header",4)(27,"ion-card-subtitle"),r(28,"Manual Entry"),i(),n(29,"ion-card-title"),r(30,"Type a Note"),i()(),n(31,"ion-card-content",14)(32,"form",15),u("ngSubmit",function(){return t.saveNote()}),n(33,"ion-item",16),a(34,"ion-input",17),i(),n(35,"ion-item",16),a(36,"ion-textarea",18),i(),n(37,"ion-button",19),a(38,"ion-icon",20),r(39," Save Note "),i()()()()()()),o&2&&(l("translucent",!0),d(14),l("disabled",t.isRecording()),d(3),l("disabled",!t.isRecording()),d(7),C(t.store.loading()?24:-1),d(8),l("formGroup",t.noteForm),d(5),l("disabled",t.noteForm.invalid))},dependencies:[A,B,Y,F,k,V,R,T,E,N,I,U,H,K,D,G,O,x,y,M,w,P],styles:[".create-content[_ngcontent-%COMP%]{--background: linear-gradient(180deg, #181818 0%, #0d0d0d 65%, #050505 100%);--padding-start: clamp(1rem, 3vw, 2.5rem);--padding-end: clamp(1rem, 3vw, 2.5rem);--padding-top: 1.25rem;--padding-bottom: 1.25rem}.content-wrapper[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;display:flex;flex-direction:column;gap:1.5rem}.glass-card[_ngcontent-%COMP%]{background:#1f1f1f;border:1px solid #2a2a2a;border-radius:20px;box-shadow:0 20px 40px #00000073}.controls[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.upload-label[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem;padding:1rem;border:2px dashed rgba(255,255,255,.2);border-radius:12px;cursor:pointer;transition:all .2s ease;color:#ffffffe6;background:#121212a6}.upload-label[_ngcontent-%COMP%]:hover{border-color:#0a84ff;background:#0a84ff1f}#audioInput[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;opacity:0;overflow:hidden}.processing[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.75rem;padding:1rem;color:#ffffffd9}ion-button[_ngcontent-%COMP%]{--border-radius: 12px;font-weight:600;transition:all .2s ease;--background: #0a84ff}ion-button[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #0a84ff4d}.create-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: transparent;--border-color: rgba(255, 255, 255, .12)}.create-content[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%], .create-content[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%]{--background: transparent;--padding-start: 0;--padding-end: 0;--highlight-color-focused: var(--ion-color-primary);--highlight-color: var(--ion-color-primary);color:#fff}.create-content[_ngcontent-%COMP%]   .native-input[_ngcontent-%COMP%], .create-content[_ngcontent-%COMP%]   .native-textarea[_ngcontent-%COMP%]{background:transparent!important}.create-card-content[_ngcontent-%COMP%]{padding:5px}.create-card-header[_ngcontent-%COMP%]{margin:0 2px}.create-button[_ngcontent-%COMP%]{margin:15px}"]});let c=s;return c})();export{de as CreatePage};
